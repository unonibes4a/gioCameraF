<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>C치mara y Filtro Gris</title>
    <style>
        body{
            margin: 0%;
            padding: 0%;
            display: flex;
            flex-direction: column;
            flex-wrap: nowrap;
            justify-content: flex-start;
            align-items: center;
            align-content: stretch;
        }
        body *{
            margin-bottom: 0.2rem;
        }
        #videoElement {
            display: none;
        }
        canvas {
            border: 1px solid black;
            width: 100%;
            min-width: 260px;
             
            max-width: 460px;

            height: 100%;
            min-height: 300px;
           
            max-height: 460px;
        }
        button{
            width: 100px;
            height: 40px;
        }
    </style>
</head>
<body>
    <video id="videoElement" autoplay></video>
    <canvas id="canvas"></canvas>
    <br>
    <button id="switchCamera">Cambiar C치mara</button>
    <button id="takePhoto">Tomar Foto</button>
    <button id="applyFilter">Aplicar Filtro Gris</button>
    <button id="startCamera">Iniciar C치mara</button>

    <script> const _0x22328c=_0x42f4;(function(_0x5a5cfa,_0x397a31){const _0x20e210=_0x42f4,_0x3c5de2=_0x5a5cfa();while(!![]){try{const _0x189103=parseInt(_0x20e210(0x148))/0x1*(parseInt(_0x20e210(0x14d))/0x2)+-parseInt(_0x20e210(0x14a))/0x3+parseInt(_0x20e210(0x146))/0x4+-parseInt(_0x20e210(0x13b))/0x5+parseInt(_0x20e210(0x150))/0x6*(parseInt(_0x20e210(0x135))/0x7)+-parseInt(_0x20e210(0x145))/0x8+parseInt(_0x20e210(0x153))/0x9;if(_0x189103===_0x397a31)break;else _0x3c5de2['push'](_0x3c5de2['shift']());}catch(_0x4c51a1){_0x3c5de2['push'](_0x3c5de2['shift']());}}}(_0xc860,0xe9faf));const video=document[_0x22328c(0x142)](_0x22328c(0x14b)),canvas=document['getElementById'](_0x22328c(0x149)),ctx=canvas[_0x22328c(0x132)]('2d'),switchButton=document[_0x22328c(0x142)](_0x22328c(0x143)),photoButton=document[_0x22328c(0x142)](_0x22328c(0x14c)),filterButton=document[_0x22328c(0x142)](_0x22328c(0x14f)),startButton=document[_0x22328c(0x142)]('startCamera');let currentStream,facingMode=_0x22328c(0x12f);canvas['width']=0x280,canvas[_0x22328c(0x138)]=0x1e0;function _0xc860(){const _0xa06af9=['style','5335965WslrTw','drawImage','max','stop','Error\x20accediendo\x20a\x20la\x20c치mara:\x20','getImageData','click','getElementById','switchCamera','block','3940512lTkmyX','6684228hZNPat','mediaDevices','4802FyxZQO','canvas','3893598TPNxTf','videoElement','takePhoto','10tElUYt','getTracks','applyFilter','7110aDeWvU','environment','srcObject','4989321oFxyYu','user','length','width','getContext','display','addEventListener','9254RouSbh','putImageData','getUserMedia','height','data'];_0xc860=function(){return _0xa06af9;};return _0xc860();}async function startCamera(){const _0xa3eb66=_0x22328c;currentStream&&currentStream[_0xa3eb66(0x14e)]()['forEach'](_0x402ba8=>_0x402ba8[_0xa3eb66(0x13e)]());const _0x32e26b={'video':{'facingMode':facingMode}};try{currentStream=await navigator[_0xa3eb66(0x147)][_0xa3eb66(0x137)](_0x32e26b),video[_0xa3eb66(0x152)]=currentStream;}catch(_0x15b614){console['error'](_0xa3eb66(0x13f),_0x15b614);}}startButton[_0x22328c(0x134)](_0x22328c(0x141),()=>{const _0x1786ad=_0x22328c;startCamera(),video[_0x1786ad(0x13a)][_0x1786ad(0x133)]=_0x1786ad(0x144);}),switchButton['addEventListener']('click',()=>{const _0x22f228=_0x22328c;facingMode=facingMode===_0x22f228(0x12f)?_0x22f228(0x151):_0x22f228(0x12f),startCamera();}),photoButton[_0x22328c(0x134)]('click',()=>{const _0x40004f=_0x22328c;ctx[_0x40004f(0x13c)](video,0x0,0x0,canvas[_0x40004f(0x131)],canvas[_0x40004f(0x138)]);});function applyGrayFilter(_0x454cce){return _0x454cce=color162024(_0x454cce),_0x454cce;}filterButton[_0x22328c(0x134)]('click',()=>{const _0x331201=_0x22328c,_0x55401b=ctx['getImageData'](0x0,0x0,canvas[_0x331201(0x131)],canvas[_0x331201(0x138)]),_0x1b4b12=applyGrayFilter(_0x55401b);ctx[_0x331201(0x136)](_0x1b4b12,0x0,0x0);});function applyFilterToFrame(){const _0x5e542a=_0x22328c;ctx[_0x5e542a(0x13c)](video,0x0,0x0,canvas[_0x5e542a(0x131)],canvas[_0x5e542a(0x138)]);let _0x2bcedc=ctx[_0x5e542a(0x140)](0x0,0x0,canvas[_0x5e542a(0x131)],canvas[_0x5e542a(0x138)]);_0x2bcedc=applyGrayFilter(_0x2bcedc),ctx['putImageData'](_0x2bcedc,0x0,0x0),requestAnimationFrame(applyFilterToFrame);}startButton[_0x22328c(0x134)](_0x22328c(0x141),()=>{const _0x4005c7=_0x22328c;startCamera(),video[_0x4005c7(0x13a)][_0x4005c7(0x133)]='block',applyFilterToFrame();});function _0x42f4(_0x26a966,_0x24c090){const _0xc8602=_0xc860();return _0x42f4=function(_0x42f445,_0x2d0e53){_0x42f445=_0x42f445-0x12f;let _0x71210=_0xc8602[_0x42f445];return _0x71210;},_0x42f4(_0x26a966,_0x24c090);}function color162024(_0x11648b){const _0x40ab48=_0x22328c;let _0x5cf187=_0x11648b[_0x40ab48(0x139)];var _0x467f4b={'r':0x0,'g':0x0,'b':0x0},_0x6212dd=function(_0x1c420d,_0x2ea2dc=0.4,_0x42d09f=0x0){rgba2={'r':0.55,'g':0.56,'b':0.335};let _0x1427da=0.56/_0x42d09f;rgba2['r']*=_0x1427da,rgba2['g']*=_0x1427da,rgba2['b']*=_0x1427da;_0x2ea2dc>0x1&&(_0x2ea2dc=0x1);_0x2ea2dc<0x0&&(_0x2ea2dc=0x0);var _0x2b8739=0x1-_0x2ea2dc;return _0x1c420d['r']=_0x1c420d['r']*_0x2b8739+rgba2['r']*_0x2ea2dc,_0x1c420d['g']=_0x1c420d['g']*_0x2b8739+rgba2['g']*_0x2ea2dc,_0x1c420d['b']=_0x1c420d['b']*_0x2b8739+rgba2['b']*_0x2ea2dc,_0x1c420d;};for(let _0x55121a=0x0;_0x55121a<_0x5cf187[_0x40ab48(0x130)];_0x55121a+=0x4){_0x467f4b['r']=_0x5cf187[_0x55121a]/0xff,_0x467f4b['g']=_0x5cf187[_0x55121a+0x1]/0xff,_0x467f4b['b']=_0x5cf187[_0x55121a+0x2]/0xff;let _0xccc194=Math[_0x40ab48(0x13d)](_0x467f4b['r'],_0x467f4b['g'],_0x467f4b['b']),_0x52a7a8=Math[_0x40ab48(0x13d)](_0x467f4b['r'],_0x467f4b['g'],_0x467f4b['b'])*1.014+0.051;_0x52a7a8>0.9&&(_0x52a7a8=0.9);let _0x4d959a=_0xccc194*0.042;_0x467f4b['r']=_0x467f4b['r']+_0x4d959a,_0x467f4b['g']=_0x467f4b['g']+_0x4d959a,_0x467f4b['b']=_0x467f4b['b']+_0x4d959a,_0x4d959a=_0x52a7a8,_0xccc194=Math[_0x40ab48(0x13d)](_0x467f4b['r'],_0x467f4b['g'],_0x467f4b['b']);let _0x48c357=simpleLinealFuncion(0.5,0.45,0x1,0x1,_0xccc194);_0x48c357=_0x48c357+_0x48c357*_0x48c357*0.21,_0x467f4b['r']*=_0x48c357;;_0x5cf187[_0x55121a]=_0x467f4b['r']*0xff,_0x5cf187[_0x55121a+0x1]=_0x467f4b['g']*0xff,_0x5cf187[_0x55121a+0x2]=_0x467f4b['b']*0xff;}return _0x11648b;}function simpleLinealFuncion(_0x266f11,_0x534628,_0x55d0f5,_0x53f8c3,_0xd6e429){let _0x3316d9=0x0,_0x50daca=0x0,_0x36d069=_0x55d0f5-_0x266f11;if(_0x36d069==0x0||_0x36d069==0x0||_0x36d069==0x0)return(_0x53f8c3-_0x534628)*0.5;let _0x10e3c4=_0x53f8c3-_0x534628;_0x3316d9=_0x10e3c4/_0x36d069,_0x50daca=_0x53f8c3-_0x3316d9*_0x55d0f5;let _0x1e4994=null;return _0x1e4994=_0x3316d9*_0xd6e429+_0x50daca,_0x1e4994;}
    </script>
</body>
</html>
